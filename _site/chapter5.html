<!DOCTYPE html>
<html lang="en">
	<head>
        <title>Fisher's Discriminant Analysis | Existing implementations of FDA</title>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
        <meta name="keywords" content="pls, partial least squares, path modeling, plspm, pls regression, herman wold, svante wold, saga pls" />
        <meta name="author" content="Gaston Sanchez" />
        <meta name="description" content="The Saga of PLS" />
        <meta name="viewport" content="width=640px, initial-scale=1.0, maximum-scale=1.0">	
        <!-- favicon -->
        <link rel="shortcut icon" href="/images/favicon.ico">
        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css" type="text/css" media="screen, projection" />
        <script type="text/javascript" async 
src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?
config=TeX-AMS-MML_HTMLorMML"></script>
	</head>
	<body>

		
<header>
	<h1>
		<a href="/">Fisher's Discriminant Analysis</a>
	</h1>
	<br>
	<small>
		by <a href="http://linkedin.com" target="_blank">SVenka</a>
	</small>
</header>


		<nav>
	<ol>
		<li>
			<a href="chapter1.html" class="">Chapter 1
			<span>A&nbsp;simple&nbsp;introduction</span> 
			</a>
		</li>
		<li>
			<a href="chapter2.html" class="">Chapter 2
			<span>Intuition</span> 
			</a>
		</li>
		<li>
			<a href="chapter3.html" class="">Chapter 3
			<span>Fisher's&nbsp;discriminant</span> 
			</a>
		</li>
		<li>
			<a href="chapter4.html" class="">Chapter 4
			<span>Mathematical&nbsp;derivation</span> 
			</a>
		</li>
		<li>
			<a href="chapter5.html" class="active">Chapter 5
			<span>Existing&nbsp;implementations</span> 
			</a>
		</li>
		<li>
			<a href="chapter6.html" class="">Chapter 6
			<span>Code&nbsp;review</span> 
			</a>
		</li>
		<li>
			<a href="chapter7.html" class="">Chapter 7
			<span>Example&nbsp;1</span> 
			</a>
		</li>
		<li>
			<a href="chapter8.html" class="">Chapter 8
			<span>Example&nbsp;2</span> 
			</a>
		</li>
		<li>
			<a href="chapter9.html" class="">Chapter 9
			<span>Some&nbsp;concluding&nbsp;remarks</span> 
			</a>
		</li>
		
	</ol>
</nav>
	

<article>

<h1 id="implementations">Implementations</h1>

<p><em>DiscriMiner</em> is an R package that implements Fisher’s discriminants. We will discuss the code in this package in some detail and use it to classify the IRIS and MNIST datasets.</p>

<h2 id="implementations-in-matlab">Implementations in Matlab</h2>

<p>In 1938 Wold received his doctorate with the thesis <em>A Study in the Analysis of Stationary Time Series</em>. For his dissertation, Wold did his research on stationary stochastic processes, studying the one-step prediction of a time series, and proposing his <em>Decomposition Theorem</em> —one of the most famous results by Wold, and one of the essential elements in the foundation of time-series analysis and forecasting. From the historical point of view, it is worth mentioning the use that Wold made of the least squares principle for his doctoral work. Herman studied the one-step prediction of a time series using the principle of least squares. Basically, Wold proved that any stationary time series can be partitioned into a deterministic component precisely predictable from its past, plus a random component which can be modeled as a weighted sum of “innovations.” In simple terms, given a series of values at different times <script type="math/tex">x_t</script>, <script type="math/tex">x</script>, <script type="math/tex">x_{t-1}</script>, <script type="math/tex">x_{t-2}</script>, <script type="math/tex">\dots</script>, <script type="math/tex">x_{t-r}</script>, the decomposition theorem is used to express <script type="math/tex">x_t</script> in terms of the preceding values as a weighted sum:</p>

<script type="math/tex; mode=display">x_t = a_1 x_{t-1} + \dots + a_r x_{t-r}</script>

<p>in which the coefficients <script type="math/tex">a_1, \dots, a_r</script> are obtained by least squares regression of <script type="math/tex">x_t</script> onto <script type="math/tex">x_{t-1}, \dots, x_{t-r}</script>. Accordingly, Wold’s decomposition showed that the three classic time-series models—the model of hidden periodicities, the moving-average model, and the autoregressive model—could be seen as different cases of the same general model. “The role of least squares,” Herman wrote, “was important too.” To the naked eye this might not seem to be very relevant but the truth is that Wold had already started to embrace least squares as one of his favorite analytical tools. From that moment on, the principle of Least Squares would occupy a central place in Wold’s mind and, without exaggeration, even a sacred place in his heart. Whatever model-building endeavors that he would later faced, he would always try to find a way for using Least Squares to estimate the parameters of a model, no matter how simple or complex the models and equations were.</p>

<h2 id="consumer-demand-analysis">Consumer Demand Analysis</h2>

<p>After his doctoral studies, Herman remained in the University of Stockholm as a lecturer on actuarial mathematics and mathematical statistics. He married Anna-Lisa Arrhenius in 1940, and they had three children: Svante, Maria and Agnes. He was very proud to be the son in law of Svante Arrhenius—the famed Swedish scientist founder of electrochemistry, and Nobel Prize for Chemistry in 1903. In 1942 Wold accepted the Chair of Statistics at the prestigious University of Uppsala, the oldest university in Sweden, founded in 1477. At the time of Wold’s arrival to Uppsala, however, the Statistics Institute was a small one, formed by one professor, one half-time assistant, and one half-time secretary. This would change in 1945 right at the end of World War II when the government decided to invest and expand Sweden’s Universities.</p>

<p>With a fresh tenure position, Wold started his own research on Demand Analysis and econometrics modeling. As a matter of fact, he had already started to work on demand analysis the summer before defending his dissertation, appointed by the Swedish government to perform such studies on the national economy. More specifically, Wold carried out the study of consumer demand analysis from 1938 to 1940. The main line of approach was to combine the analysis of family budget data and market statistics (time-series data) so as to obtain a unified picture of the demand structure in Sweden between 1920 and 1938. The airs of war were starting to fill Europe’s atmosphere and it was clear that if a conflict broke out, government rationing policies for food and goods would need to be implemented. As Europe entered the War period, Wold’s work intensified, measuring price and income elasticities of demand—how sensitive the consumer demand was to changes in prices and income.</p>

<p>Although the government commission only lasted two years, Wold spent about 14 years doing research and time series analysis of the collected data, as well as publishing several articles between 1938 and 1947. One of such publications appeared in 1940 in the dual form of a research report; written by Herman Wold and Lars Juréen that material would later be used for a specialized textbook on econometrics <em>Demand Analysis: A study in econometrics</em> (published in 1952)—which became a classic in the field. “The monograph is written,” Wold said, “in the dual form of a research report and a specialized textbook on econometrics.” Like in his doctoral research, Herman Wold made extensive use of Least Squares for estimating the parameters in his models and making accurate forecasts.</p>

<h2 id="the-least-squares-affair">The Least Squares Affair</h2>

<p>Directly related with his work on Time Series and Demand Analysis, Wold got involved in a peculiar confrontation that happened within econometrics during the 1940s: Ordinary Least Squares against Maximum Likelihood. This period is crucial for the development of PLS because this is the time when Wold, somewhat stubbornly, embraced the Least Squares principle against most other methods, especially against the overuse of Maximum Likelihood. To understand why, we need to talk a bit more about econometrics and demand analysis.</p>

<p>During the first half of the twentieth century, one of the greatest challenges in econometrics was the estimation of demand analysis equations, and simultaneous equation systems. Before the 1940s, the main analytical tool used for this task was ordinary least squares (OLS). Although it was not the perfect tool, OLS was able to get the job done in most occasions. However, as models started to become more sophisticated, there were more and more cases where OLS simply didn’t seem to work. Consequently, the method of least-squares started to being criticized and some econometricians began to stress out that the device was not foolproof if applied uncritically.</p>

<p>Partly due to lack of understanding, partly due to conceptual confussions, econometric theorists were burdened with a myriad of problems that took many years to be solved or to be aware of. We’re talking about things like <em>identification</em>, <em>measurement errors</em>, <em>multicollinearity</em>, <em>model choice</em>, and so forth, that are known to affect not only OLS but many other estimation methods when applied to economic time-series and simultaneous equations. These issues are now taught in most introductory and intermediate econometrics courses, but back in Wold’s days all these problems were the cause of so many headaches for econometricians trying to figure out how the economic systems work.</p>

<p>Around the early 1940s, the challenges posed by econometric models attracted many mathematicians, statisticians, and economists. This “gold rush in macroeconomic model building,” as Wold used to call it, captivated the minds of very talented economists. Among the most <em>avant-garde</em> groups was the Oslo school of thought, whose most distinguished protagonist was the Norwegian Trygve Magnus Haavelmo (Economics Nobel in 1989). Haavelmo’s most proclaimed accomplishment was the <em>Probability Revolution in Econometrics</em> initiated in 1943 with the premise of adoptating a probability approach in Econometrics. Among other things, he was also the one who highlighted the problems of Least Squares when applied for estimating simultaneous equation systems.</p>

<p>Trygve wrote two influential articles: the <em>The statistical implications of a system of simultaneous equations</em> in 1943, and <em>The Probability Approach to Econometrics</em> published in 1944 as a supplement in the journal <em>Econometrica</em>. Both works set a before-and-after in Econometrics. On the one hand, Haavelmo introduced modern statistical inference based on probability models to economics. Although he was not the first one to introduce elements of probability theory into economics models, he was the first one to import the statistical inference approach for testing hypotheses. On the other hand, Haavelmo proposed the idea of using several structural equations <em>simultaneously</em> to construct econometric models following a probability approach.</p>

<p>Broadly speaking, one of the main questions among economic researchers had to do with: How to mathematically model the economy’s behavior? For instance, how to model a system of equations for demand and supply? In a very simple model the <em>Demand</em> of a good, say coffee, depended on the price. In turn, the <em>Supply</em> of coffee depended on how much demand was for coffee, as well as the cost of production. While there was no doubt about the general theory of demand-and-supply, there was a heated debate on the mathematical and statistical form such theory should took.</p>

<p>The Oslo school advocated for a system in which demand and supply affected each other simultaneously—at the same time:</p>

<script type="math/tex; mode=display">D_t = a_1 S_t + \epsilon_t  \quad  \text{demand} \\
S_t = b_1 D_t + b_2 P_t + \delta_t  \quad  \text{supply}</script>

<p>The Demand equation reflects the behavior of the <em>consumers</em> of coffee: they respond to the price of coffee—reflected in <script type="math/tex">a_1 S_t</script>. The Supply equation reflects the behavior of the <em>producers</em> of coffee: they set the price <script type="math/tex">P_t</script> depending on how much demand <script type="math/tex">b_1 D_t</script> there is for coffee, as well as the cost of production. In other words, the demand and supply for coffee are simultaneously determined. Simultaneous equation systems can be much more complex and sophisticated, but one of the basic ideas, as its name indicates, is that of <em>simultaneity</em>. More important, Wold disagreed with this model of demand and supply in which both relationships were determined within the same time period. He found it difficult to believe that the economic system was determined simultaneously. For him, causal forces only worked in one direction at any one time and these forces should be reflected in the models.</p>

<p>The Stockholm school, strongly based on the works of Dutch economist Jan Tinbergen—first Nobel Prize in Economics, 1969—thought of an economic system not in terms of simultaneity, but in terms of time-lagged periods. Tinbergen called these types of model <em>causal chain systems</em> and he used to illustrate them with <em>arrow schemes</em>, very similar to the path diagrams that would later be employed within structural equation models as wel as within path models.</p>

<p>Herman Wold had been formed under the Stockholm school tradition, in which the  econometric models of causal chains included an <em>ex ante–ex post</em> component. Basically, these models did not include the idea of simultaneity, but rather a time-lag component in which one thing had to occur first, and then another thing would followed. Taking the demand-and-supply example of Coffee, the associated equations would be expressed as:</p>

<script type="math/tex; mode=display">D_t = a_1 S_{t-1} + \epsilon_t  \quad  \text{demand} \\
S_t = b_1 D_t + b_2 P_t + \delta_t  \quad  \text{supply}</script>

<p>Wold put emphasis on knowing the interrelations of all the variables in terms of the time lapse between causes and effects. In this way, one could reduce the system of dynamic causal relations to one final form equation. The condition to achieve such reduced form involved no simultaneously determined equations like Haavelmo suggested.</p>

<p>Before Haavelmo’s contributions, the errors <script type="math/tex">\epsilon_t</script> and <script type="math/tex">\delta_t</script> in the models were thought to be due to measurement discrepancies. What Trygve proposed instead was to treat the errors in the statistical sense of random noise, and assign them a certain distribution. In this way, the Maximum Likelihood device had the door open, allowing researcher to test and discard hypothesis. His advice was to avoid using Ordinary Least Squares (OLS), since this method provided inconsistent results when applied to simultaneous equation models. Instead, he favored and promoted the use of Maximum Likelihood.</p>

<h3 id="wolds-effort-to-rescue-ols">Wold’s effort to rescue OLS</h3>

<p>Haavelmo’s advice against OLS was a shocking statement for Wold. “I felt so disturbed,” Herman wrote, “by Haavelmo’s wholesale dismissal of it.” Considering that all of Wold’s work had been based on OLS, and that he had achieved very good results with it, he was very surprised by the bad press least squares received. Herman was anything but “spurred” by Haavelmo’s “rejection of OLS regression.” Could it be possible that Haavelmo was right and that OLS were to be banned? If that were the case, all results previously obtained by Herman were useless, something that didn’t seem to match at all with his analysis and practical evidence.</p>

<p>In the middle of the 1940s, together with Ragnar Bentzel, Herman set out on a task to see whether Trygve Haavelmo was right or not. They intensely studied the simultaneous systems of equations and, to Wold’s relieve, they found hope for Least Squares, publishing the proofs and conclusions in the 1946 article <em>“On statistical demand analysis from the viewpoint of simultaneous equations”</em>. Simultaneous equation models could be divided in two broad categories: <em>recursive</em> simultaneous equations and <em>non-recursive</em> simultaneous equations. Or as Wold preferred to call them: <strong>causal chain</strong> systems and <strong>interdependent</strong> systems, respectively. When a system could be expressed in recursive form, Wold and Bentzel showed that the method of Ordinary Least Squares could be perfectly used to estimate such models and give equivalent results to those under Maximum Likelihood. The challenge, however, was with the non-recursive models where OLS did not provide adequate results. This issue would obsess Wold for the next decades, trying to find a way that would let him estimate non-recursive systems with Least Squares.</p>

<p>By the end of the 1940s, Herman Wold had already been working for over 17 or so years (1932 - 1949) on a number of topics including time series, insurance statistics, analysis of consumer demand, and econometric systems of equations. Moreover, he was basically the only Scandinavian econometrician outside of Oslo with international reputation. Niels Kaergard gives a revealing description of how Wold was perceived among the econometrics community (<a href="references.html/#Kaergard2012">Kaergard, 2012</a>):</p>

<blockquote>
  <p>“Where the Oslo school was a central part of the internatinal mainstream econometric tradition in the 1930s, 1940s, and 1950s, Wold was seen as a man with a rather special point of view.”</p>
</blockquote>

<p>In summary, the main question of debate became whether the structure of economic models was simultaneous or recursive? This was reflected in the theme <em>“Toward a verdict on macroeconomic simultaneous equations”</em>, title of a publication edited by Wold. The main stream in econometrics for estimating simultaneous equation systems was the one based on the method of Maximum Likelihood. Wold was not part of this group. On the contrary, Herman was a prominent figure in favor of recursivity and use of least squares, a stance that he would maintain for the rest of his life. However, it was Haavelmo’s point of view that became the dominating one. The Maximum Likelihood convenience and elegance offered the mechanism of hypothesis testing, too tempting and irresistible to let it go by most researchers.</p>

<p>Wold always tried in one way or another to find a solution by least squares. Making distinction between simultaneous equations of recursive and non-recursive type, Bentzel and Wold showed that Haavelmo’s wholesale dismissal of OLS estimation of the structural equations was applicable to non-recursive systems only, but not for recursive systems. For approximately the following 15 years, Wold went on a tortuouse mission to find an OLS solution for non-recursive systems.</p>

<p><a class="continue" href="chapter6.html">Next chapter</a></p>



</article>


<footer>
	<p>	Fisher's Discriminant Analysis <br>
	<small>
	&copy; <a href="www.linkedin.com" target="_blank">SVenka</a>. &nbsp;&nbsp;Some rights reserved.
	</small></p>
</footer>

	



	</body>
</html>
